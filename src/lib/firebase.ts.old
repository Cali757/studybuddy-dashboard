WHISPER VOICE â€” STEP 1.3
Speech â†’ Text (Whisper)

Still calm. Still clean.
We are doing ONE job only in this step:

Take audio â†’ turn it into text â†’ log it

NO AI answering yet.
NO speaking back yet.

ğŸ¯ GOAL OF STEP 1.3

When you finish:

You speak into the mic

Whisper turns it into text

Backend logs the words you said

Thatâ€™s it.

ğŸ§  WHAT WEâ€™RE USING

We will use OpenAI Whisper API (industry standard).

You already have:

Audio file

Firebase Function

Secure pipeline

Weâ€™re just adding Whisper inside the function.

ğŸ“ STEP 1.3.1 â€” ADD OPENAI KEY (SAFE WAY)

In Firebase Functions folder:

firebase functions:config:set openai.key="YOUR_OPENAI_API_KEY"


Then redeploy later.

âš ï¸ Do NOT put this in frontend code.

ğŸ“ STEP 1.3.2 â€” INSTALL OPENAI SDK

Inside functions/:

npm install openai

ğŸ“ STEP 1.3.3 â€” UPDATE uploadVoice FUNCTION

Replace your uploadVoice function with this:

const OpenAI = require("openai");
const Busboy = require("busboy");
const fs = require("fs");
const path = require("path");
const os = require("os");

exports.uploadVoice = functions.https.onRequest(async (req, res) => {
  if (req.method !== "POST") {
    return res.status(405).send("Method Not Allowed");
  }

  const busboy = Busboy({ headers: req.headers });
  const tmpdir = os.tmpdir();
  let filePath = "";

  busboy.on("file", (fieldname, file, info) => {
    const { filename } = info;
    filePath = path.join(tmpdir, filename);
    file.pipe(fs.createWriteStream(filePath));
  });

  busboy.on("finish", async () => {
    const openai = new OpenAI({
      apiKey: functions.config().openai.key,
    });

    const transcription = await openai.audio.transcriptions.create({
      file: fs.createReadStream(filePath),
      model: "whisper-1",
    });

    console.log("ğŸ“ TRANSCRIPTION:", transcription.text);

    fs.unlinkSync(filePath);

    res.json({
      success: true,
      text: transcription.text,
    });
  });

  busboy.end(req.rawBody);
});

ğŸš€ DEPLOY AGAIN
firebase deploy --only functions

ğŸ§ª TEST STEP 1.3

Click ğŸ¤

Speak clearly:

â€œWhat is a freight broker?â€

Stop recording

Check:

Firebase logs

You should see:

ğŸ“ TRANSCRIPTION: What is a freight broker?


ğŸ‰ WHISPER IS WORKING

ğŸ§  WHAT YOU JUST UNLOCKED

You now have:

Real speech recognition

Production-grade Whisper

Voice input ready for AI answers

This is the hard part of voice apps.
Everything else is just reuse.